# BSG Stroke Classifier

Welcome to the documentation for the **BSG Stroke Classifier**, a machine learning project designed to predict the likelihood of stroke events using patient medical records. This project focuses on the analysis, preprocessing, and modeling of healthcare data to build a reliable binary classifier.

---

## Project Overview

The goal of this project is to explore a healthcare dataset and build an end-to-end classification pipeline for stroke prediction. It includes:

- **Data cleaning** and imputation of missing values.
- **Exploratory Data Analysis (EDA)** to understand feature relationships.
- **Preprocessing**, including encoding and scaling.
- **Machine learning modeling** using classification algorithms.
- **Evaluation metrics** to assess performance.
- A clean and **reproducible structure** using Python, Poetry, and MkDocs.

---

## Project Structure

```bash
bsg-testdatascience-1/
â”œâ”€â”€ data/ # Raw and processed data files
â”œâ”€â”€ docs/ # Documentation (MkDocs)
â”œâ”€â”€ notebooks/ # EDA and experimentation notebooks
â”œâ”€â”€ stroke_predictor/ # Source code and utility functions
â”‚ â”œâ”€â”€ configs/ # YAML configurations
â”‚ â”œâ”€â”€ optuna_optimization/ # Optuna-based model optimization
â”‚ â”œâ”€â”€ utils/ # Preprocessing, plotting, and I/O helpers
â”‚ â””â”€â”€ tests/ # Unit tests
â”œâ”€â”€ templates/ # HTML templates for the web interface
â”œâ”€â”€ pyproject.toml # Poetry config
â”œâ”€â”€ mkdocs.yml # MkDocs config
â””â”€â”€ README.md # Project overview
```

---

## Documentation Contents

- **Exploratory Data Analysis** â€“ Summary statistics, visualizations, and patterns in the dataset.
- **Preprocessing Utilities** â€“ Code for missing value imputation, encoding, and normalization.
- **Modeling Pipeline** â€“ Train/test splits, model training, and evaluation.
- **Testing** â€“ Unit tests for critical components.
- **API Reference** â€“ Autogenerated from code docstrings using MkDocs + `mkdocstrings`.
- **Hyperparameter Optimization** â€“ Tuning with Optuna.
- **Web Interface** â€“ Simple UI for predictions via Flask.

---

## How to Use

1. Clone the repository:
   ```bash
   git clone https://github.com/borja-sg/BSG-TestDataScience-1
   cd BSG-TestDataScience-1
   ```

2. Install dependencies using Poetry:
   ```bash
   poetry install
   ```

3. Run notebooks or scripts from the root folder.

---

## ðŸ§ª Optimization and Web Inference

### Run Hyperparameter Optimization with Optuna
To perform model tuning and log results:
```bash
nohup poetry run python stroke_predictor/optuna_optimization/runner.py ./stroke_predictor/configs/optuna.yml &
```

To start the Optuna dashboard:
```bash
optuna-dashboard sqlite:///outputs/optuna_stroke_prediction.db --host 0.0.0.0 --port 8888
```

### Train Model Using Best Parameters
```bash
nohup poetry run python stroke_predictor/train_model.py ./stroke_predictor/configs/train.yml &
```

### Launch Web Inference App
```bash
uvicorn stroke_predictor.main:app --host 0.0.0.0 --port 8888 --reload
```

Then open your browser at:
```
http://localhost:8888/web
```
