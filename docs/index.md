# BSG Stroke Classifier

Welcome to the documentation for the **BSG Stroke Classifier**, a machine learning project designed to predict the likelihood of stroke events using patient medical records. This project focuses on the analysis, preprocessing, and modeling of healthcare data to build a reliable binary classifier.

---

## Project Overview

The goal of this project is to explore a healthcare dataset and build an end-to-end classification pipeline for stroke prediction. It includes:

- **Data cleaning** and imputation of missing values.
- **Exploratory Data Analysis (EDA)** to understand feature relationships.
- **Preprocessing**, including encoding and scaling.
- **Machine learning modeling** using classification algorithms.
- **Evaluation metrics** to assess performance.
- A clean and **reproducible structure** using Python, Poetry, and MkDocs.

---

## Project Structure

```bash
bsg-testdatascience-1/
├── data/ # Raw and processed data files
├── docs/ # Documentation (MkDocs)
├── notebooks/ # EDA and experimentation notebooks
├── stroke_predictor/ # Source code and utility functions
│ ├── configs/ # YAML configurations
│ ├── optuna_optimization/ # Optuna-based model optimization
│ ├── utils/ # Preprocessing, plotting, and I/O helpers
│ └── tests/ # Unit tests
├── templates/ # HTML templates for the web interface
├── pyproject.toml # Poetry config
├── mkdocs.yml # MkDocs config
└── README.md # Project overview
```

---

## Documentation Contents

- **Exploratory Data Analysis** – Summary statistics, visualizations, and patterns in the dataset.
- **Preprocessing Utilities** – Code for missing value imputation, encoding, and normalization.
- **Modeling Pipeline** – Train/test splits, model training, and evaluation.
- **Testing** – Unit tests for critical components.
- **API Reference** – Autogenerated from code docstrings using MkDocs + `mkdocstrings`.
- **Hyperparameter Optimization** – Tuning with Optuna.
- **Web Interface** – Simple UI for predictions via Flask.

---

## How to Use

1. Clone the repository:
   ```bash
   git clone https://github.com/borja-sg/BSG-TestDataScience-1
   cd BSG-TestDataScience-1
   ```

2. Install dependencies using Poetry:
   ```bash
   poetry install
   ```

3. Run notebooks or scripts from the root folder.

---

## Running Steps

1. **Exploratory Data Analysis (EDA)**  
   Run the notebook to perform data cleaning, seasonality analysis, and feature engineering:  
   ```bash
   poetry run jupyter notebook
   ```  
   Open and execute `notebooks/eda.ipynb`.

2. **Optuna Hyperparameter Optimization**  
   Run automated model tuning with Optuna:  
   ```bash
   poetry run python series_predictor/optuna_optimization/runner.py ./series_predictor/configs/optuna.yml
   ```  
   Training progress and results are logged with MLflow.

3. **Model Evaluation**  
   Evaluate the trained model using:  
   ```bash
   poetry run jupyter notebook
   ```  
   Then open and run `notebooks/evaluation.ipynb`.
